# Nessus Vulnerability Management Lab

## Description
In this lab I will be creating an environment where we will be detecting and remediating vulnerabilities found in the target VM according to the Vulnerability Management Lifecycle. We want to Discover, Prioritize, Asses, Report, Remediate and Verify. I will be performing both credentialed and non-credentialed scans to demonstrate the big difference it makes to use a credentialed vs a non-credentialed scan and why this matters when applied to a production environment. 

## For this lab I will be using:

- VMWare VirtualBox
- Windows 10 ISO
- Nessus Essentials

## Walkthrough

The first thing we have to do is create an account in Nessus, go to your Nessus portal, and here we will be setting up a new scan based on our needs. There is multiple types of scans but for this lab we will focus in a Basic Network Scan. 

![1](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/73554e38-277e-4fbf-b1dd-a0bfd8e83d1c)

After specifying the target IP (or range) address, we run the scan. We just have to wait for it to be finished so I can look at the results. It will take a bit.

![2](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/21d15083-9d43-4bf6-967d-441cbc5e52cf)

It is important to note that this first scan is non-credentialed, meaning that Nessus doesn't have access to many parts of the Operating System, similar to what an attacker would be able to see from the outside without proper authentication. After a while, we have the results for the scan. We notice that there is a lot of informational vulnerabilities, but nothing really serious. 

![3](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/92be2493-e614-4bf0-aa3a-15a30f0c4104)

If I click in one of the vulnerabilities, it will go in-depth in explaining exactly why this represents a vulnerability for the system and how to solve it. Also, we can pay attention to some key indicators such as it's CVSS score (Common Vulnerability Scoring System, an open framework for severity in software vulnerabilities, which ranges from 1 to 10, being 1 not dangerous at all to 10 - Critical issue).

![4](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/990917d3-de3d-41c8-b344-09b9d6999c8f)

After configuring the VM (deactivating Windows Firewall, enabling file sharing, enabling SMB and certain ports that Nessus needs to perform the scan and setting up a registry key according to Nessus instructions) I will setup a credentialed scan. A credentialed scan will be able to perform any operation that a local user can perform, which means that I will give it the VMs login information and it will be able to see everything as an admin. This is the most effective type of vulnerability scanning.  

![5](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/69d4fc62-cdd9-4e11-99a1-a9ca2b83f27a)

For this lab, we installed a deprecated version of Firefox and Windows Updates have not been installed (as this is a fresh VM). As you can see on the results, there is a huge difference in high and critical vulnerabilities when compared to the non-credentialed scan. This is because with a credentialed scan Nessus is able to check as deep as the Windows Registry and everything in between. 

![6](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/0ae34e0f-03b8-4d00-897b-a85bf1bd7143)

![7](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/ba3853d1-6818-45be-b427-4642f7261dcd)

We will be remediating some of this critical vulnerabilities. Nessus will recommend solutions, but the application of this solution will vary depending on your environment. In a small home lab environment you can tackle solutions directly, but in a business environment you might have to follow your team's SOPs (Standard Operating Procedures) or Change Management.

![8](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/2e57b8fd-222e-4531-b61c-173c67362b07)

There is several options, we can decide to Remediate (Remediation occurs when the threat can be eradicated), Mitigate (This is more like damage control; the issue cannot be eliminated immediately but it can be minimized), or risk acceptance (perhaps patching a system would render it unusable, this is totally unrecommended but it can happen in real life, in which case all parties have to come to an agreement to either migrate to a newer system or patch the current one). This are the results after applying a current Windows patch and removing the depricated Firefox version:

![9](https://github.com/art-wiju/Nessus-Vulnerability-Management/assets/132944565/42cc3e45-a9a8-4d39-a00c-b3b03c4afb43)

As you can see, there is a big difference in Critical and High risk vulnerabilities just by keeping your Windows up-to-date and also keeping your third-party software patched. In a real business environment we would ideally like to schedule vulnerability scans on a daily basis in non-production hours when they will not interfere with normal operations. 
